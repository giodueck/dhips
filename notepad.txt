TODO:
    - Add user roles
    - Add user creation and editing
    - Add instalation routine to help with testing

Installation
- create database
- create default user, prompt user to change the default password
    username: admin
    password: admin
- create config directory with 740 permissions and root:www-data owner
- create config files with 740 permissions and root:www-data owner
    connstring: dbname=dhips user=postgres password=postgres

Manual

Documentation
- config files

Web Pages
- index.html: redirects to /cgi-bin/login
- /cgi-bin/login: login form
- /cgi-bin/main: main page
- /cgi-bin/logout: redirects to /cgi-bin/login

Login
- index.html redirects to the login script
- login script asks for login info, and takes query argument to display errors like invalid user/password
- login script opens the main script which verifies if the login info is good, if not redirects back to login script
- main script page will be logged in through one of 2 modes:
    1. login (post): on successful login, main will create a new session, which will be stored in a file, and reload in session mode.
    2. session (get): a session will have an expiration date, set to 5 minutes from login originally. Every time the main script or
        a subpage is opened and the expiration date has not been reached, it will be reset to 5 minutes from then.
        If the session has expired or no session is active, the main script will redirect to the login script with
        the current user as an argument, and the user will need to log in again.
failed login attempts should be logged in the dhips log

Logout
- main page will have a logout button, which will close the session immediately.
- a session expires after 5 minutes of inactivity, after which login will be needed again.

User creation and password editing
- main script will have a section for changing password
- main script will have a section for assigning permissions, default user will have admin
- main script will have a secion for admin tasks
- main script sections should either be collapsible or different pages alltogether

Roles
- admin: full privileges. Can add/edit users, edit dhips configurations, view process status, start/restart and stop process
- user: normal privileges. Can edit own password, edit dhips configurations, view process status and start/restart process
- spectator: restricted privileges. Can edit own password and view dhips configurations and process status

HIDPS
- alert flags:
    - regular: reporting of regular activity
    - important: reporting of important activity, advise
    - warning: reporting of suspicious activity, take note
    - caution: reporting of dangerous activity, take action
- warnings will cause the system to log an event into a watchlist, which will make less suspicious but related events
    also show up as warnings. Repeated warnings will escalate to caution alerts.
- caution alerts will cause the system to take action, requiring an admin to revert if necesary
- important alerts will involve anything that is of importance but not necesarily suspicious, like the addition of a user

List and description of tasks:
i:      IDS:
            important: changes to binaries and system files, new users
            warning: changes to system binaries and system files
ii:     IDS:
            regular: user connected from localhost
            important: user connected remotely
iii:    IDS:
            important: system in promiscuous mode
            caution: sniffers running
iv:     IDS:
            warning: repeated authentication failure in a short time
            caution: massive authentication failure in a short time
            warning: repeated 404 from the same ip in a short time
            caution: massive mail from one account
v:      IDS:
            warning: repeated mail from one account in a short time
            caution: massive mail from one account in a short time
vi:     IDS:
            warning: process with high memory usage
            caution: process with high memory usage for a long time
vii:    IDS:
            caution: script or executable found in /tmp
            caution: process running from /tmp
viii:   IDS:
            caution: DDOS attack detected
ix:     IDS:
            important: cron job running
x:      IDS:
            warning: repeated authentication failure in a short time
            caution: massive authentication failure in a short time